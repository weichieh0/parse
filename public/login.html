<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="scripts/parse-1.6.14.min.js"></script>

    <script src="scripts/hbUtility.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

    <!-- Latest compiled and minified CSS -->
    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <!-- Optional theme -->
    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">-->
    <!-- Latest compiled and minified JavaScript -->
    <!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>-->

    <script src="scripts/jquery-2.2.0.min.js"></script>
    <script src="scripts/bootstrap.min.js"></script>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-theme.min.css" rel="stylesheet">


    <link href="css/signin.css" rel="stylesheet">

    <title>小蜜蜂小幫手</title>
</head>
<body>
    <div id="test">
    </div>
    <div class="container">

        <!--<form class="login-form" action="javascript:;" onsubmit="return myFunction(this)">
            <h2>Log In</h2>
            <div class="error" style="display:none"></div>
            <input type="text" id="login-username" placeholder="Username" />
            <input type="password" id="login-password" placeholder="Password" />
            <button>Log In</button>
        </form>-->


        <form class="form-signin" action="javascript:;" onsubmit="return myFunction(this)">
            <h2 class="form-signin-heading">Please sign in</h2>
            <label for="inputEmail" class="sr-only" id="emailLabel">Email address</label>
            <input type="email" id="inputEmail" class="form-control" placeholder="Email address" required autofocus>
            <label for="inputPassword" class="sr-only">Password</label>
            <input type="password" id="inputPassword" class="form-control" placeholder="Password" required>

            <!--<div class="checkbox">
                <label>
                    <input type="checkbox" value="remember-me"> Remember me
                </label>
            </div>-->

            <br>
            <button class="btn btn-lg btn-primary btn-block" id="signInBtn">Sign in</button>
        </form>

    </div> <!-- /container -->


    <script>

        var parseInit = function () {
            Parse.initialize("9O3uQHctMnz86F6m3lifIlwKrMGONwlUjO2OL4uf", "nbkR1HRcOkFEa4J73rPsWvaZsqa6O6BHI0GSGClz");

            //test
            // Parse.initialize("UWZqpCsyFQWnyLTChFrK6t19NyLtmm7m0W2gP2ul", "GSmSLSAz7FfGyfXXB9wCvtwIJULXPHBFkM2PzwdZ");

        };

        var init = function () {
            parseInit();
        };

        init();

        var myFunction = function () {
        
            console.log("signInBtn click");
            var email = $("#inputEmail").val();
            var password = $("#inputPassword").val();

            console.log("inputEmail: " + email);
            console.log("inputPassword: " + password);

            Parse.User.logOut().then(function(){
                var currentUser = Parse.User.current();  // this will now be null
            });

            Parse.User.logIn(email, password, {
                success: function (user) {

                    var user = Parse.User.current();

                    if (user == null) {
                        console.log("user = null");
                        alert("無此帳號");

                    } else {
                        console.log("user id = " + user.id);
                        var qualify = user.get('qualify');
                        console.log("user qualify = " + qualify);
                        alert(user.get('contact') + " 您好!");
                        window.open("orderManagement.html", "_parent","",true);
                    }

                },
                error: function (user, error) {

                    console.log("The login failed. Check error to see why.");
                    alert("The login failed. Check error to see why.");
                    // The login failed. Check error to see why.
                }
            });


            //return true;
        };


        $(function () {
            //var parseInit = function () {
            //    Parse.initialize("9O3uQHctMnz86F6m3lifIlwKrMGONwlUjO2OL4uf", "nbkR1HRcOkFEa4J73rPsWvaZsqa6O6BHI0GSGClz");

            //    //test
            //    //Parse.initialize("UWZqpCsyFQWnyLTChFrK6t19NyLtmm7m0W2gP2ul", "GSmSLSAz7FfGyfXXB9wCvtwIJULXPHBFkM2PzwdZ");
            //}

            //var init = function () {
            //    parseInit();
            //}

            //init();

            $("#signInBtn").click(function () {

                //console.log("signInBtn click");
                //var email = $("#inputEmail").val();
                //var password = $("#inputPassword").val();
                //console.log("inputEmail: " + email);
                //console.log("inputPassword: " + password);

                //Parse.User.logIn("customer001", "123456", {
                //    success: function (user) {

                //        var user = Parse.User.current();
                //        if (user == null) {
                //            console.log("user = null");
                //        } else {
                //            console.log("user id = " + user.id);
                //            var qualify = user.get('qualify');
                //            console.log("user qualify = " + qualify);
                //        }
                //    },
                //    error: function (user, error) {

                //        console.log("The login failed. Check error to see why.");

                //        // The login failed. Check error to see why.
                //    }
                //});

            });

        });

    </script>
</body>
</html>